language: generic

os: osx
osx_image: xcode7.2

sudo: False

env:
  matrix:
    - CONDA_PY=27
    - CONDA_PY=34

  global:
    # Generated with "anaconda auth --create --name mpifft4py-2016 > token"
    # then "travis encrypt BINSTAR_TOKEN=token --repo spectralDNS/mpiFFT4py"
    - secure: "Ducz6xTrnRxYW69/lCsGGBaqDMaGnSM1UW8WocKrCy4DhoFpdxyglcntQL9pcq4C/HGwvnBsorJCLxcLDkNnZ5est2akDPtPZvKrhpMFqLK3oO7GGTMB2ddLu50OdRz58fTUFlEDVHgmSKliHunN7IRleaLTXtbluFDUKTLs00krKO5NfqO6lGZ/fH1mNFmhjU4ZYWTkvTBi5Wb+kG6bLDiMQjBCYyG9erPrx4IPjbtiHM/W4JLXgxIMMuhUolSq6N3+xNSeQ+ynfjQNDZhMM6k/boZC0fnqQpTmqPKMk9mvwSXEiTUpNwLGrD8P9iHeMj1QTeF58qFKoPGOhQhSWuVq1BugPOoo9Wm28WzvAfcnPlj/EOAOGAqDRUq5mDc3tv2Ea5ErtKUFCJAb8iTrpJAINugbu74m0vqDOzkteGm69QSa9Lj3w1iMqJ5iP/zsAZy+cK+Egd77rL0EdvRoJeNEZoyPt1vUAmy3WJIJXAIWlSr8kHGbT1gnQunPlXZp+29jBfOz4OKOEAGNzQeSZwJTw75urWPS8yFAOlIOwJ8rt3toTpxlP/5lsIKU/J6ykSKiFRV0824Bv+K9fY6CtCxjZMbq4aJu2zZVoqni59tHs26PEbRzHRsXXvQlB1y4hvOteHQsePITmKuqSeAJn2MgQj5BBh01LW5c0MVNoaQ="
    #- secure: "qOIS3J7nrdN7fIbX2txUw7AurwRTDBdWz0dge/lAt0u2wPwNSXjdEvRD5uYd0E6/6Q0LHOyn4PTY7YOQFHmm9REq4gBvugW8ZXvqcNhRhXvlv8Q6ksnW8GGvZ1O5IcipZS6KtxXckar5lXDy/Dcipt4vrOKij31/sRyR7FmsyoGgenNlf/8RLcNFxoP7HU10PLSVj44JGpFhkeeIYujeQMnGCSrp/ucQk5fQltTo3FDK3R/LaeJFzvF6q0bCFPS934N7D9MOMAtZMSLPnKJi0Zzr2XaPzmdOECGow+0xBGdBwYiq95LViTHSa0v1dwCNrsavH6RmNNV0R/7CcuRdbM+wMchXRz2fxiz40dg6keJxUmPcWn4PnTiPnNwB8k3RFrPnIBSoK4dXeB5DxvV+PT8hvUzgnP+5JecJOk2+lGXA6EU9iJLYVfO6vdOohzrsz+g281RQWtCQsCt8feh7XmsFcIEUq31BA86t7U1WbeD4GTUogGn+OZIIm9r+RF7j1AURMyOB4ee32/MQXivz6tMOC2M7dovFiwYZUPGJjsB05TYCxl8qkJVvegNKlVUojZu2NIDoHJCKyu+ZjVmk1fSScTQ+UPaf9F9Aqql9CAIQ8Ck6KqZiSPfwVoaAj3mLX3FeOoQXFHtiLUX8fj0+4/pv/2he9e85dagy2hQhRfY="

before_install:
    # Remove homebrew.
    - brew remove --force $(brew list)
    - brew cleanup -s
    - rm -rf $(brew --cache)

install:
    - |
      MINICONDA_URL="https://repo.continuum.io/miniconda"
      MINICONDA_FILE="Miniconda3-latest-MacOSX-x86_64.sh"
      curl -L -O "${MINICONDA_URL}/${MINICONDA_FILE}"
      bash $MINICONDA_FILE -b
      source /Users/travis/miniconda3/bin/activate root
      conda config --set show_channel_urls true
      conda config --add channels conda-forge
      conda update -q conda
      conda install --yes --quiet conda-forge-build-setup
      source run_conda_forge_build_setup

script:
    - conda build conf/conda

after_success:
    - anaconda -t $BINSTAR_TOKEN upload --force /Users/travis/miniconda3/conda-bld/osx-64/*.tar.bz2 -u spectralDNS -c main
