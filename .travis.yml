language: generic

os: osx
osx_image: xcode7.2

sudo: False

env:
  matrix:
    - CONDA_PY=27
    - CONDA_PY=34

  global:
    # Generated with "anaconda auth --create --name mpifft4py-2016 > token"
    # then "travis encrypt BINSTAR_TOKEN=token --repo spectralDNS/mpiFFT4py"
    #- secure: "Ducz6xTrnRxYW69/lCsGGBaqDMaGnSM1UW8WocKrCy4DhoFpdxyglcntQL9pcq4C/HGwvnBsorJCLxcLDkNnZ5est2akDPtPZvKrhpMFqLK3oO7GGTMB2ddLu50OdRz58fTUFlEDVHgmSKliHunN7IRleaLTXtbluFDUKTLs00krKO5NfqO6lGZ/fH1mNFmhjU4ZYWTkvTBi5Wb+kG6bLDiMQjBCYyG9erPrx4IPjbtiHM/W4JLXgxIMMuhUolSq6N3+xNSeQ+ynfjQNDZhMM6k/boZC0fnqQpTmqPKMk9mvwSXEiTUpNwLGrD8P9iHeMj1QTeF58qFKoPGOhQhSWuVq1BugPOoo9Wm28WzvAfcnPlj/EOAOGAqDRUq5mDc3tv2Ea5ErtKUFCJAb8iTrpJAINugbu74m0vqDOzkteGm69QSa9Lj3w1iMqJ5iP/zsAZy+cK+Egd77rL0EdvRoJeNEZoyPt1vUAmy3WJIJXAIWlSr8kHGbT1gnQunPlXZp+29jBfOz4OKOEAGNzQeSZwJTw75urWPS8yFAOlIOwJ8rt3toTpxlP/5lsIKU/J6ykSKiFRV0824Bv+K9fY6CtCxjZMbq4aJu2zZVoqni59tHs26PEbRzHRsXXvQlB1y4hvOteHQsePITmKuqSeAJn2MgQj5BBh01LW5c0MVNoaQ="
    - secure: "F6lk/xCws5WBfG11I/bIeO6fjpOVsVbfV5hsIkqvU2bJ0JZWB7g/J1qwxfuEqzLseeV4QxjlGzN5k8b6nf3MqA69XjSce1CQkVnWqeJiWeJEpE/wqFBfpgqLSj6z3YSB2l6yM1B3wJeXvkpAltbGrvms/uitkVfknKbODiEedIgtsENBR+tzOZG+oq5TiZXcqtCSKBIa897hlDjtov3WC2KBEuxuOS0ibizjaXooh707l39LJw8BxTTO8dXRD2REv2jQYYtPqRoE6FxJzsP8HV1xNdA8zUj8eEgpnrXjxAGtXwioS9XWDPKKpyiF0xcXp9NiTqJQZKGdYYmL17hKZOrTSH0MC7Yor6CbbnnWuqOAh5z4h8GYyLHMpQCHi6PMRnCvQuwaJviqvbqSgGcMIyQf6Bm89totWp2aToH4/faeUtMrjh0gNxDVPUv6dYHBiZwavnOVce1Lwo/CXLGG/t+cM1gNEr6oEcTxfL/7mT8QVCEmNpWRs6uy0Fop38znVg2Je+E29VH4Z23lCXEX0TQ1DhQuqmdjN1y9W2/GsIEmLPu0fMni4bkrZtZcVBuQzvTD3W/3yI7l0DHUX0o5n2JwLnDLDzny5O40wrQHeu/O//VCnrXHBFsYEMVmwLbW32uMW/SipCXnDnzalUZ4gQ1wTBzoY+kHicnl4AjEx0w="

before_install:
    # Remove homebrew.
    - brew remove --force $(brew list)
    - brew cleanup -s
    - rm -rf $(brew --cache)

install:
    - |
      MINICONDA_URL="https://repo.continuum.io/miniconda"
      MINICONDA_FILE="Miniconda3-latest-MacOSX-x86_64.sh"
      curl -L -O "${MINICONDA_URL}/${MINICONDA_FILE}"
      bash $MINICONDA_FILE -b
      source /Users/travis/miniconda3/bin/activate root
      conda config --set show_channel_urls true
      conda config --add channels conda-forge
      conda update -q conda
      conda install --yes --quiet conda-forge-build-setup
      source run_conda_forge_build_setup

script:
    - conda build conf/conda

after_success:
    - anaconda -t $BINSTAR_TOKEN upload --force /Users/travis/miniconda3/conda-bld/osx-64/*.tar.bz2 -c main
